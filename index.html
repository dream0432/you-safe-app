<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>You Safe - ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ (‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå)</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap" rel="stylesheet">
    
    <style>
        /* --- ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô --- */
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Kanit', sans-serif; background-color: #f0f2f5; min-height: 100vh; display: flex; justify-content: center; align-items: center; padding: 20px; overflow-x: hidden; position: relative; }
        
        /* Layout */
        .selection-screen { display: flex; gap: 30px; text-align: center; width: 100%; max-width: 900px; justify-content: center; }
        .form-screen, .admin-screen { display: none; width: 100%; max-width: 600px; animation: fadeIn 0.5s ease; }
        
        /* Card Styles */
        .role-card { width: 100%; max-width: 400px; background: white; padding: 50px 30px; border-radius: 20px; cursor: pointer; box-shadow: 0 10px 30px rgba(0,0,0,0.05); border: 2px solid transparent; transition: all 0.3s ease; }
        .role-card:hover { transform: translateY(-10px); box-shadow: 0 20px 40px rgba(0,0,0,0.1); border-color: #FF8C42; }
        .role-icon { font-size: 4rem; margin-bottom: 20px; display: block; }
        .role-card h2 { color: #FF8C42; font-size: 1.8rem; margin-bottom: 10px; }
        .role-card p { color: #777; }

        /* Form Styles */
        .form-box { background: white; padding: 40px; border-radius: 20px; border-top: 8px solid #FF8C42; box-shadow: 0 15px 35px rgba(0,0,0,0.1); }
        .form-header h2 { margin-bottom: 5px; color: #333; }
        .form-header p { color: #888; margin-bottom: 20px; font-size: 0.9rem; }
        textarea { width: 100%; height: 200px; padding: 15px; border: 2px solid #eee; border-radius: 12px; font-family: 'Kanit', sans-serif; resize: none; margin-bottom: 20px; font-size: 1rem; }
        textarea:focus { outline: none; background-color: #fafafa; border-color: #FF8C42; }
        
        /* Buttons */
        .action-btn { width: 100%; padding: 15px; border: none; border-radius: 10px; color: white; font-size: 1.1rem; cursor: pointer; background-color: #FF8C42; font-weight: 600; }
        .action-btn:hover { opacity: 0.9; }
        .back-btn { display: inline-block; margin-bottom: 15px; color: #666; cursor: pointer; font-size: 0.9rem; }
        .back-btn:hover { text-decoration: underline; }

        /* Admin Styles */
        .admin-box { background: white; padding: 30px; border-radius: 20px; border-top: 8px solid #333; box-shadow: 0 15px 35px rgba(0,0,0,0.1); }
        .message-item { border-bottom: 1px solid #eee; padding: 15px 0; display: flex; justify-content: space-between; align-items: flex-start; }
        .msg-content { flex: 1; margin-right: 15px; }
        .msg-text { font-size: 1rem; color: #333; margin-bottom: 5px; white-space: pre-wrap; }
        .msg-date { font-size: 0.8rem; color: #999; }
        .delete-btn { background: #ff4d4d; color: white; border: none; padding: 5px 12px; border-radius: 6px; cursor: pointer; font-size: 0.8rem; }
        .delete-btn:hover { background: #d93636; }
        .admin-toggle { position: fixed; bottom: 10px; right: 10px; background: transparent; border: none; color: #ccc; cursor: pointer; font-size: 0.8rem; }
        .admin-toggle:hover { color: #333; }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        .hidden { display: none !important; }
    </style>
</head>
<body>

    <div class="selection-screen" id="selectionScreen">
        <div class="role-card" id="btnVenter">
            <span class="role-icon">üò´</span>
            <h2>‡∏ú‡∏π‡πâ‡∏£‡∏∞‡∏ö‡∏≤‡∏¢</h2>
            <p>‡∏â‡∏±‡∏ô‡∏°‡∏µ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÑ‡∏°‡πà‡∏™‡∏ö‡∏≤‡∏¢‡πÉ‡∏à ‡∏≠‡∏¢‡∏≤‡∏Å‡πÄ‡∏•‡πà‡∏≤‡πÉ‡∏´‡πâ‡πÉ‡∏Ñ‡∏£‡∏™‡∏±‡∏Å‡∏Ñ‡∏ô‡∏ü‡∏±‡∏á</p>
        </div>
    </div>

    <div class="form-screen" id="formScreen">
        <a class="back-btn" id="btnBackForm">‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
        <div class="form-box">
            <div class="form-header">
                <h2>üò´ ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ô‡πÉ‡∏à</h2>
                <p>‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡∏≤‡∏ß‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡∏à‡∏∞‡∏ñ‡∏π‡∏Å‡∏™‡πà‡∏á‡πÑ‡∏õ‡πÄ‡∏Å‡πá‡∏ö‡∏£‡∏±‡∏Å‡∏©‡∏≤‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢</p>
            </div>
            <textarea id="formInput" placeholder="‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏à‡∏≠‡∏≠‡∏∞‡πÑ‡∏£‡∏°‡∏≤‡∏ö‡πâ‡∏≤‡∏á? ‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£?..."></textarea>
            <button class="action-btn" id="btnSend">‡∏™‡πà‡∏á‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡∏≤‡∏ß</button>
        </div>
    </div>

    <div class="admin-screen" id="adminScreen">
        <a class="back-btn" id="btnBackAdmin">‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
        <div class="admin-box">
            <h2>üîí Admin Dashboard</h2>
            <p>‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏à‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Realtime)</p>
            <ul style="list-style:none; margin-top:20px;" id="messageList">
                <p style="text-align:center; color:#ccc;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
            </ul>
        </div>
    </div>

    <button class="admin-toggle" id="btnAdminLogin">Admin Login</button>

    <script type="module">
        // 1. ‡∏ô‡∏≥‡πÄ‡∏Ç‡πâ‡∏≤ Library
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, push, onValue, remove } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        // 2. Config ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì (‡πÉ‡∏™‡πà‡πÉ‡∏´‡πâ‡πÅ‡∏•‡πâ‡∏ß!)
        const firebaseConfig = {
            apiKey: "AIzaSyDemVd2LZXn-wTWon-KOxIdN3AxkzASnkY",
            authDomain: "you-safe-6a7bd.firebaseapp.com",
            databaseURL: "https://you-safe-6a7bd-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "you-safe-6a7bd",
            storageBucket: "you-safe-6a7bd.firebasestorage.app",
            messagingSenderId: "770251925608",
            appId: "1:770251925608:web:b64c667a14837ad05df3dd",
            measurementId: "G-JPRR8JM77J"
        };

        // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô Firebase
        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        const messagesRef = ref(db, 'messages');

        // --- ‡∏™‡πà‡∏ß‡∏ô‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠ (UI Logic) ---
        const selectionScreen = document.getElementById('selectionScreen');
        const formScreen = document.getElementById('formScreen');
        const adminScreen = document.getElementById('adminScreen');
        const formInput = document.getElementById('formInput');
        const messageList = document.getElementById('messageList');

        // ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏´‡∏ô‡πâ‡∏≤
        document.getElementById('btnVenter').onclick = () => {
            selectionScreen.classList.add('hidden');
            formScreen.style.display = 'block';
        };

        document.getElementById('btnBackForm').onclick = () => {
            formScreen.style.display = 'none';
            selectionScreen.classList.remove('hidden');
        };

        document.getElementById('btnBackAdmin').onclick = () => {
            adminScreen.style.display = 'none';
            selectionScreen.classList.remove('hidden');
        };

        // --- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• ---
        document.getElementById('btnSend').onclick = () => {
            const text = formInput.value.trim();
            if (text === "") return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏á‡∏ô‡∏∞");

            // ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏∂‡πâ‡∏ô Firebase
            push(messagesRef, {
                text: text,
                date: new Date().toLocaleString('th-TH')
            })
            .then(() => {
                alert("‡∏™‡πà‡∏á‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡∏≤‡∏ß‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡∏Ñ‡∏£‡∏±‡∏ö :)");
                formInput.value = ''; // ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
                document.getElementById('btnBackForm').click(); // ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
            })
            .catch((error) => {
                alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡πà‡∏á: " + error.message);
            });
        };

        // --- ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô Admin Login ---
        document.getElementById('btnAdminLogin').onclick = () => {
            const pwd = prompt("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô Admin:");
            if(pwd === "1234") { // <--- ‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô
                selectionScreen.classList.add('hidden');
                adminScreen.style.display = 'block';
            }
        };

        // --- ‡∏ü‡∏±‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Firebase ‡πÅ‡∏ö‡∏ö Realtime ---
        onValue(messagesRef, (snapshot) => {
            messageList.innerHTML = ""; // ‡∏•‡πâ‡∏≤‡∏á‡∏à‡∏≠‡∏£‡∏≠‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏´‡∏°‡πà
            const data = snapshot.val();
            
            if (data) {
                // ‡πÅ‡∏õ‡∏•‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏õ‡πá‡∏ô Array ‡πÅ‡∏•‡∏∞‡∏Å‡∏•‡∏±‡∏ö‡∏î‡πâ‡∏≤‡∏ô (‡πÉ‡∏´‡∏°‡πà‡∏™‡∏∏‡∏î‡∏Ç‡∏∂‡πâ‡∏ô‡∏Å‡πà‡∏≠‡∏ô)
                const list = Object.entries(data).reverse(); 
                
                list.forEach(([key, value]) => {
                    const li = document.createElement('li');
                    li.className = 'message-item';
                    li.innerHTML = `
                        <div class="msg-content">
                            <div class="msg-text">${value.text}</div>
                            <div class="msg-date">${value.date}</div>
                        </div>
                        <button class="delete-btn" data-key="${key}">‡∏•‡∏ö</button>
                    `;
                    messageList.appendChild(li);
                });

                // ‡πÉ‡∏™‡πà Event ‡πÉ‡∏´‡πâ‡∏õ‡∏∏‡πà‡∏°‡∏•‡∏ö
                document.querySelectorAll('.delete-btn').forEach(btn => {
                    btn.onclick = function() {
                        if(confirm("‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡∏µ‡πâ?")) {
                            // ‡∏™‡∏±‡πà‡∏á‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ö‡∏ô Cloud
                            remove(ref(db, 'messages/' + this.dataset.key));
                        }
                    }
                });
            } else {
                messageList.innerHTML = "<p style='text-align:center; color:#999;'>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡πà‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤</p>";
            }
        });

    </script>
</body>
</html>