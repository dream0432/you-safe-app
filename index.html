<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>You Safe - ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏•‡∏≠‡∏î‡∏†‡∏±‡∏¢ (‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå)</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap" rel="stylesheet">
    
    <style>
        /* --- ‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡∏û‡∏∑‡πâ‡∏ô‡∏ê‡∏≤‡∏ô --- */
        * { box-sizing: border-box; margin: 0; padding: 0; }
        body { font-family: 'Kanit', sans-serif; background-color: #f0f2f5; min-height: 100vh; display: flex; justify-content: center; align-items: center; padding: 20px; overflow-x: hidden; position: relative; }
        
        /* Layout */
        .selection-screen { display: flex; gap: 30px; text-align: center; width: 100%; max-width: 900px; justify-content: center; }
        .form-screen, .admin-screen { display: none; width: 100%; max-width: 600px; animation: fadeIn 0.5s ease; }
        
        /* Card Styles */
        .role-card { width: 100%; max-width: 400px; background: white; padding: 50px 30px; border-radius: 20px; cursor: pointer; box-shadow: 0 10px 30px rgba(0,0,0,0.05); border: 2px solid transparent; transition: all 0.3s ease; }
        .role-card:hover { transform: translateY(-10px); box-shadow: 0 20px 40px rgba(0,0,0,0.1); border-color: #FF8C42; }
        .role-icon { font-size: 4rem; margin-bottom: 20px; display: block; }
        .role-card h2 { color: #FF8C42; font-size: 1.8rem; margin-bottom: 10px; }
        .role-card p { color: #777; }

        /* Form Styles */
        .form-box { background: white; padding: 40px; border-radius: 20px; border-top: 8px solid #FF8C42; box-shadow: 0 15px 35px rgba(0,0,0,0.1); }
        .form-header h2 { margin-bottom: 5px; color: #333; }
        .form-header p { color: #888; margin-bottom: 20px; font-size: 0.9rem; }
        textarea { width: 100%; height: 200px; padding: 15px; border: 2px solid #eee; border-radius: 12px; font-family: 'Kanit', sans-serif; resize: none; margin-bottom: 20px; font-size: 1rem; }
        textarea:focus { outline: none; background-color: #fafafa; border-color: #FF8C42; }
        
        /* Buttons */
        .action-btn { width: 100%; padding: 15px; border: none; border-radius: 10px; color: white; font-size: 1.1rem; cursor: pointer; background-color: #FF8C42; font-weight: 600; }
        .action-btn:hover { opacity: 0.9; }
        .back-btn { display: inline-block; margin-bottom: 15px; color: #666; cursor: pointer; font-size: 0.9rem; }
        .back-btn:hover { text-decoration: underline; }

        /* Admin Styles */
        .admin-box { background: white; padding: 30px; border-radius: 20px; border-top: 8px solid #333; box-shadow: 0 15px 35px rgba(0,0,0,0.1); }
        .message-item { border-bottom: 1px solid #eee; padding: 15px 0; display: flex; justify-content: space-between; align-items: flex-start; }
        .msg-content { flex: 1; margin-right: 15px; }
        .msg-text { font-size: 1rem; color: #333; margin-bottom: 5px; white-space: pre-wrap; }
        .msg-date { font-size: 0.8rem; color: #999; }
        .delete-btn { background: #ff4d4d; color: white; border: none; padding: 5px 12px; border-radius: 6px; cursor: pointer; font-size: 0.8rem; }
        .delete-btn:hover { background: #d93636; }
        .admin-toggle { position: fixed; bottom: 10px; right: 10px; background: transparent; border: none; color: #ccc; cursor: pointer; font-size: 0.8rem; }
        .admin-toggle:hover { color: #333; }

        /* --- Custom Modal (‡∏Å‡∏•‡πà‡∏≠‡∏á‡πÄ‡∏î‡πâ‡∏á‡πÅ‡∏ö‡∏ö‡πÉ‡∏´‡∏°‡πà) --- */
        .modal-overlay {
            display: none; /* ‡∏ã‡πà‡∏≠‡∏ô‡πÑ‡∏ß‡πâ‡∏Å‡πà‡∏≠‡∏ô */
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.6); /* ‡∏â‡∏≤‡∏Å‡∏´‡∏•‡∏±‡∏á‡∏™‡∏µ‡∏î‡∏≥‡∏à‡∏≤‡∏á‡πÜ */
            z-index: 1000;
            justify-content: center; align-items: center;
        }
        .modal-box {
            background: white; padding: 50px 30px; border-radius: 25px;
            text-align: center; max-width: 90%; width: 500px;
            box-shadow: 0 20px 50px rgba(0,0,0,0.3);
            animation: popIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .modal-text {
            font-size: 1.8rem; /* ‡∏ï‡∏±‡∏ß‡πÉ‡∏´‡∏ç‡πà‡∏™‡∏∞‡πÉ‡∏à */
            font-weight: 600; color: #4A4A4A;
            margin-bottom: 30px; line-height: 1.5;
        }
        .modal-btn {
            background: #FF8C42; color: white; border: none;
            padding: 12px 40px; font-size: 1.2rem; border-radius: 50px;
            cursor: pointer; font-family: 'Kanit', sans-serif;
            transition: transform 0.2s;
        }
        .modal-btn:hover { transform: scale(1.05); }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
        @keyframes popIn { from { transform: scale(0.5); opacity: 0; } to { transform: scale(1); opacity: 1; } }
        .hidden { display: none !important; }
    </style>
</head>
<body>

    <div class="modal-overlay" id="successModal">
        <div class="modal-box">
            <p class="modal-text">‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏≠‡∏¢‡∏π‡πà‡∏Ç‡πâ‡∏≤‡∏á‡πÜ ‡∏ï‡∏±‡∏ß‡∏Ñ‡∏∏‡∏ì<br>‡πÉ‡∏ô‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡πÅ‡∏¢‡πà‡∏´‡∏£‡∏∑‡∏≠‡∏•‡πâ‡∏°‡∏•‡∏á‡πÄ‡∏™‡∏°‡∏≠</p>
            <button class="modal-btn" onclick="closeModal()">‡∏ï‡∏Å‡∏•‡∏á</button>
        </div>
    </div>

    <div class="selection-screen" id="selectionScreen">
        <div class="role-card" id="btnVenter">
            <span class="role-icon">üò´</span>
            <h2>‡∏ú‡∏π‡πâ‡∏£‡∏∞‡∏ö‡∏≤‡∏¢</h2>
            <p>‡∏â‡∏±‡∏ô‡∏°‡∏µ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡πÑ‡∏°‡πà‡∏™‡∏ö‡∏≤‡∏¢‡πÉ‡∏à ‡∏≠‡∏¢‡∏≤‡∏Å‡πÄ‡∏•‡πà‡∏≤‡πÉ‡∏´‡πâ‡πÉ‡∏Ñ‡∏£‡∏™‡∏±‡∏Å‡∏Ñ‡∏ô‡∏ü‡∏±‡∏á</p>
        </div>
    </div>

    <div class="form-screen" id="formScreen">
        <a class="back-btn" id="btnBackForm">‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
        <div class="form-box">
            <div class="form-header">
                <h2>üò´ ‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏∞‡∏ö‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡πÉ‡∏ô‡πÉ‡∏à</h2>
                <p>‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡∏≤‡∏ß‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏£‡∏≤‡∏à‡∏∞‡∏£‡∏±‡∏ö‡∏ü‡∏±‡∏á‡∏°‡∏±‡∏ô‡πÑ‡∏ß‡πâ‡πÄ‡∏≠‡∏á</p>
            </div>
            <textarea id="formInput" placeholder="‡∏ß‡∏±‡∏ô‡∏ô‡∏µ‡πâ‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏à‡∏≠‡∏≠‡∏∞‡πÑ‡∏£‡∏°‡∏≤‡∏ö‡πâ‡∏≤‡∏á? ‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÑ‡∏£?..."></textarea>
            <button class="action-btn" id="btnSend">‡∏™‡πà‡∏á‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡∏≤‡∏ß</button>
        </div>
    </div>

    <div class="admin-screen" id="adminScreen">
        <a class="back-btn" id="btnBackAdmin">‚Üê ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å</a>
        <div class="admin-box">
            <h2>üîí Admin Dashboard</h2>
            <p>‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î‡∏à‡∏≤‡∏Å‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Realtime)</p>
            <ul style="list-style:none; margin-top:20px;" id="messageList">
                <p style="text-align:center; color:#ccc;">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</p>
            </ul>
        </div>
    </div>

    <button class="admin-toggle" id="btnAdminLogin">Admin Login</button>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, push, onValue, remove } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDemVd2LZXn-wTWon-KOxIdN3AxkzASnkY",
            authDomain: "you-safe-6a7bd.firebaseapp.com",
            databaseURL: "https://you-safe-6a7bd-default-rtdb.asia-southeast1.firebasedatabase.app",
            projectId: "you-safe-6a7bd",
            storageBucket: "you-safe-6a7bd.firebasestorage.app",
            messagingSenderId: "770251925608",
            appId: "1:770251925608:web:b64c667a14837ad05df3dd",
            measurementId: "G-JPRR8JM77J"
        };

        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);
        const messagesRef = ref(db, 'messages');

        const selectionScreen = document.getElementById('selectionScreen');
        const formScreen = document.getElementById('formScreen');
        const adminScreen = document.getElementById('adminScreen');
        const formInput = document.getElementById('formInput');
        const messageList = document.getElementById('messageList');
        const successModal = document.getElementById('successModal'); // ‡∏î‡∏∂‡∏á Modal ‡∏°‡∏≤‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô

        // ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏´‡πâ window ‡πÄ‡∏£‡∏µ‡∏¢‡∏Å‡πÉ‡∏ä‡πâ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô closeModal ‡πÑ‡∏î‡πâ
        window.closeModal = function() {
            successModal.style.display = 'none'; // ‡∏ã‡πà‡∏≠‡∏ô Modal
            formInput.value = ''; // ‡∏•‡πâ‡∏≤‡∏á‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°
            document.getElementById('btnBackForm').click(); // ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
        }

        document.getElementById('btnVenter').onclick = () => {
            selectionScreen.classList.add('hidden');
            formScreen.style.display = 'block';
        };

        document.getElementById('btnBackForm').onclick = () => {
            formScreen.style.display = 'none';
            selectionScreen.classList.remove('hidden');
        };

        document.getElementById('btnBackAdmin').onclick = () => {
            adminScreen.style.display = 'none';
            selectionScreen.classList.remove('hidden');
        };

        document.getElementById('btnSend').onclick = () => {
            const text = formInput.value.trim();
            if (text === "") return alert("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏û‡∏¥‡∏°‡∏û‡πå‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡πà‡∏≠‡∏ô‡∏™‡πà‡∏á‡∏ô‡∏∞");

            push(messagesRef, {
                text: text,
                date: new Date().toLocaleString('th-TH')
            })
            .then(() => {
                // *** ‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡∏à‡∏≤‡∏Å Alert ‡πÄ‡∏õ‡πá‡∏ô‡πÅ‡∏™‡∏î‡∏á Modal ‡πÅ‡∏ó‡∏ô ***
                successModal.style.display = 'flex'; 
            })
            .catch((error) => {
                alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: " + error.message);
            });
        };

        document.getElementById('btnAdminLogin').onclick = () => {
            const pwd = prompt("‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÉ‡∏™‡πà‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô Admin:");
            if(pwd === "Thongchai2549") {
                selectionScreen.classList.add('hidden');
                adminScreen.style.display = 'block';
            }
        };

        onValue(messagesRef, (snapshot) => {
            messageList.innerHTML = "";
            const data = snapshot.val();
            
            if (data) {
                const list = Object.entries(data).reverse(); 
                
                list.forEach(([key, value]) => {
                    const li = document.createElement('li');
                    li.className = 'message-item';
                    li.innerHTML = `
                        <div class="msg-content">
                            <div class="msg-text">${value.text}</div>
                            <div class="msg-date">${value.date}</div>
                        </div>
                        <button class="delete-btn" data-key="${key}">‡∏•‡∏ö</button>
                    `;
                    messageList.appendChild(li);
                });

                document.querySelectorAll('.delete-btn').forEach(btn => {
                    btn.onclick = function() {
                        if(confirm("‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏à‡∏∞‡∏•‡∏ö‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡∏µ‡πâ?")) {
                            remove(ref(db, 'messages/' + this.dataset.key));
                        }
                    }
                });
            } else {
                messageList.innerHTML = "<p style='text-align:center; color:#999;'>‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡πà‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤</p>";
            }
        });

    </script>
</body>
</html>


